<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>
<script src="libs/navigation-1.1/codefolding.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, target-densityDpi=device-dpi" />
<meta name="format-detection" content="telephone=no" />
<script src="libs/exploratory/resources/jquery.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/d3.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/chroma.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/showdown.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/viz.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/jquery.balloon.min.js?cb=cb1663212112609"></script>
<link href="libs/exploratory/resources/viz-base.css?cb=cb1663212112609" rel="stylesheet"></link>
<script src="libs/exploratory/resources/plotly.min.js?cb=cb1663212112609"></script>
<script src="libs/exploratory/resources/plotly-locale-ja.js?cb=cb1663212112609"></script>
<link href="libs/exploratory/resources/plotly-custom.css?cb=cb1663212112609" rel="stylesheet"></link>
<link href="libs/exploratory/resources/pivot.css?cb=cb1663212112609" rel="stylesheet"></link>

<style  type="text/css">
  /* pivot adjustment */
  .pivot-metainfo {
    display:none;
  }
  .viz-container {
   -webkit-font-smoothing: antialiased;
   -moz-osx-font-smoothing: grayscale;
  }
</style>
<script src="libs/exploratory\layout\CNN4Vdl2.js"></script>
<script src="libs/exploratory\layout\sNl1CTo4.js"></script>
<script src="libs/exploratory\layout\hEK3mvR3.js"></script>
<script src="libs/exploratory\layout\jBr7TUs8.js"></script>
<script src="libs/exploratory\layout\Bdk5TQN6.js"></script>
<script src="libs/exploratory\layout\REi7OGV8.js"></script>
<script src="libs/exploratory\layout\EZm6pyy1.js"></script>
<script src="libs/exploratory\layout\KYi7aMo6.js"></script>
<script src="libs/exploratory\layout\DAD2PSL1.js"></script>
<script src="libs/exploratory\layout\mVD0HBQ3.js"></script>
<script src="libs/exploratory\layout\wmm9oRz0.js"></script>
<script src="libs/exploratory\layout\wpl2nOb6.js"></script>
<script src="libs/exploratory\layout\ail6RUX3.js"></script>
<script src="libs/exploratory\layout\qjB9Lbe8.js"></script>
<script src="libs/exploratory\layout\yRG7ODI2.js"></script>
<script src="libs/exploratory\layout\tDV0pWq0.js"></script>
<script src="libs/exploratory\layout\UPw7WjY8.js"></script>
<script src="libs/exploratory\layout\PWb3Cbf1.js"></script>
<script src="libs/exploratory\layout\mCM4Ebw8.js"></script>
<script src="libs/exploratory\analytics\kzQ4GZW5.js"></script>




<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="libs/exploratory/resources/note-base.css?cb=20220915T032152459Z" type="text/css" />
<link rel="stylesheet" href="libs/exploratory/resources/microtip.css?cb=20220915T032152459Z" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>





<style type="text/css">
/* Styles for plain html output with a single column layout, which is 
   either no TOC or no-floating TOC case.  */ 
.main-container {
  max-width: 770px!important; /* it overrides 940px hardcoded by rmarkdown. 700px + padding left/right */
  padding-left:30px;
  padding-right:40px;
}
</style>

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<div id="heart-disease-dataset" class="section level1">
<h1><span class="header-section-number">1</span> Heart Disease Dataset</h1>
<p>In this dataset has been published in the UCI Machine Learning Repository. It has 303 rows and 16 coulumns. I am going to check for outliers, missing values, and the trends and relationships among different features with R. For the original dataset, please <a href="https://archive.ics.uci.edu/ml/datasets/Heart+Disease">click here</a></p>
<div id="features-metadata" class="section level2">
<h2><span class="header-section-number">1.1</span> Features (metadata):</h2>
<ol style="list-style-type: decimal">
<li>age: age in years</li>
<li>sex: sex (1 = male; 0 = female)</li>
<li>cp: chest pain type -- Value 1: typical angina -- Value 2: atypical angina -- Value 3: non-anginal pain -- Value 4: asymptomatic</li>
<li>rest_bp: resting blood pressure (in mm Hg on admission to the hospital)</li>
<li>chol: serum cholestoral in mg/dl</li>
<li>restecg: resting electrocardiographic results -- Value 0: normal -- Value 1: having ST-T wave abnormality (T wave inversions )</li>
<li><ol start="5" style="list-style-type: decimal">
<li>fbs: (fasting blood sugar &gt; 120 mg/dl) (1 = true; 0 = false)</li>
</ol></li>
<li>thalach: maximum heart rate achieved</li>
<li>exang: exercise induced angina (1 = yes; 0 = no)</li>
<li>slope: the slope of the peak exercise ST segment -- Value 1: upsloping -- Value 2: flat -- Value 3: downsloping</li>
<li>ca: number of major vessels (0-3) colored by flourosopy</li>
<li>thal: 0 = normal; 1 = fixed defect; 2 = reversable defect</li>
<li>target: diagnosis of heart disease (angiographic disease status) -- Value 0: &lt; 50% diameter narrowing -- Value 1: &gt; 50% diameter narrowing</li>
<li>Oldpeak: ST depression induced by exercise relative to rest.</li>
</ol>
</div>
<div id="r-code" class="section level2">
<h2><span class="header-section-number">1.2</span> R code</h2>
<p>This is the code that used in data wrangling step before visualising the data</p>
<pre><code># Load required packages.
library(janitor)
library(tidyr)
library(stringr)
library(readr)
library(forcats)
library(dplyr)
library(tibble)
library(exploratory)

# Set working directory so that the script can read saved data file.
setwd(&quot;data path&quot;); jsonlite::toJSON(TRUE)
# Steps to produce the output
exploratory::read_delim_file(&quot;https://raw.githubusercontent.com/PacktWorkshops/The-Data-Analysis-Workshop/master/Chapter07/Dataset/heart.csv&quot;, delim = NULL, quote = &quot;\&quot;&quot; , col_names = TRUE , na = c(&#39;&#39;) , locale=readr::locale(encoding = &quot;UTF-8&quot;, decimal_mark = &quot;.&quot;, tz = &quot;Africa/Cairo&quot;, grouping_mark = &quot;,&quot; ), trim_ws = TRUE , progress = FALSE) %&gt;%
  readr::type_convert() %&gt;%
  exploratory::clean_data_frame() %&gt;%
    #rename the dataframe for its orginal names
  rename(chest_pain = cp, rest_bp = trestbps, fast_bld_sugar = fbs, rest_ecg = restecg, st_deper = oldpeak, max_hr = thalach, ex_angina = exang, colored_vessels = ca, thalassemia = thal, cholestrol=chol)</code></pre>
</div>
</div>
<div id="first-using-the-box-plot-for-detecting-outliers" class="section level1">
<h1><span class="header-section-number">2</span> First, using the box plot for detecting outliers</h1>
<div id="checking-the-outliers-for-cholesterol" class="section level3">
<h3><span class="header-section-number">2.0.1</span> Checking the outliers for cholesterol</h3>
</div>
<div id="cholestrol-boxplot" class="section level2">
<h2><span class="header-section-number">2.1</span> cholestrol BoxPlot</h2>
<script data-id="viz_1" data-object-name="viz_CNN4Vdl2" data-viz="CNN4Vdl2" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_1" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>In the previous chart, there are a few outliers beyond the 370.</p>
<div id="checking-the-outliers-for-st_depr" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Checking the outliers for st_depr</h3>
</div>
</div>
<div id="st_depr" class="section level2">
<h2><span class="header-section-number">2.2</span> st_depr</h2>
<script data-id="viz_2" data-object-name="viz_sNl1CTo4" data-viz="sNl1CTo4" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_2" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<div id="boxplot-for-colored_vessels" class="section level3">
<h3><span class="header-section-number">2.2.1</span> BoxPlot for colored_vessels</h3>
</div>
</div>
<div id="colored_vessels" class="section level2">
<h2><span class="header-section-number">2.3</span> colored_vessels</h2>
<script data-id="viz_3" data-object-name="viz_hEK3mvR3" data-viz="hEK3mvR3" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_3" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<div id="checking-outliers-for-thalassemia" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Checking outliers for thalassemia</h3>
</div>
</div>
<div id="thalassemia" class="section level2">
<h2><span class="header-section-number">2.4</span> thalassemia</h2>
<script data-id="viz_4" data-object-name="viz_jBr7TUs8" data-viz="jBr7TUs8" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_4" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>Note: from the preceding boxplots, there are some outliers. However, they will not be imputed as there are few data to start with. i just show them.</p>
<hr />
</div>
</div>
<div id="showing-the-disturbance-and-realtionship-between-certain-features" class="section level1">
<h1><span class="header-section-number">3</span> Showing the disturbance and realtionship between certain features</h1>
<div id="age-distributions" class="section level3">
<h3><span class="header-section-number">3.0.1</span> Age distributions</h3>
</div>
<div id="age" class="section level2">
<h2><span class="header-section-number">3.1</span> Age</h2>
<script data-id="viz_5" data-object-name="viz_Bdk5TQN6" data-viz="Bdk5TQN6" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_5" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>We can observe that the youngest patient was 29 years old, while the oldest was 77, and the majority of patients were between 50s and 60s years old. The most common age is 58 years old.</p>
<div id="getting-the-number-of-patients-who-have-heart-disease-and-those-who-have-not" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Getting the number of patients who have heart disease and those who have not</h3>
</div>
</div>
<div id="target-count" class="section level2">
<h2><span class="header-section-number">3.2</span> target count</h2>
<p><script data-id="viz_6" data-object-name="viz_REi7OGV8" data-viz="REi7OGV8" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_6" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div> in the preceding table, 1 means has the disease, while 0 has not. ### Now, I am going to represent them visually with count plot</p>
</div>
<div id="target-count-plot" class="section level2">
<h2><span class="header-section-number">3.3</span> target count plot</h2>
<script data-id="viz_7" data-object-name="viz_EZm6pyy1" data-viz="EZm6pyy1" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_7" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<div id="then-count-plot-representing-the-distribution-of-presence-of-heart-disease-by-sex" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Then, count plot representing the Distribution of Presence of Heart Disease by Sex</h3>
</div>
</div>
<div id="sex-summary-count" class="section level2">
<h2><span class="header-section-number">3.4</span> sex summary count</h2>
<script data-id="viz_8" data-object-name="viz_KYi7aMo6" data-viz="KYi7aMo6" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_8" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
</div>
<div id="target-gpby-present-absent" class="section level2">
<h2><span class="header-section-number">3.5</span> target gpby present absent</h2>
<script data-id="viz_9" data-object-name="viz_DAD2PSL1" data-viz="DAD2PSL1" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_9" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>From the previous graphs, we can conclude that 72 out of 96 female patients have been diagnosed with heart disease. This scenario is opposite for the male patients, most of them have not been diagnosed with heart disease.</p>
<hr />
</div>
</div>
<div id="the-distributions-and-relationships-among-columns-with-respect-to-the-target-column." class="section level1">
<h1><span class="header-section-number">4</span> The distributions and relationships among columns with respect to the target column.</h1>
<div id="chest-pain-count" class="section level2">
<h2><span class="header-section-number">4.1</span> chest pain count</h2>
<script data-id="viz_10" data-object-name="viz_mVD0HBQ3" data-viz="mVD0HBQ3" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_10" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
</div>
<div id="presence-of-heart-disease-by-chest-pain-type" class="section level2">
<h2><span class="header-section-number">4.2</span> Presence of Heart Disease by Chest Pain Type</h2>
<script data-id="viz_11" data-object-name="viz_wmm9oRz0" data-viz="wmm9oRz0" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_11" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>This chart shows us that most of patients have typical angina, and the next is non-anginal pain followed by angina. Most of patients who had typical angina were not diagnose with heart disease. The largest group who had been diagnosed with heart disease had non-anginal pain.</p>
<hr />
</div>
</div>
<div id="colored-vessel" class="section level1">
<h1><span class="header-section-number">5</span> Colored Vessel</h1>
<div id="colored-vesssels-summary" class="section level2">
<h2><span class="header-section-number">5.1</span> colored vesssels summary</h2>
<script data-id="viz_12" data-object-name="viz_wpl2nOb6" data-viz="wpl2nOb6" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_12" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
</div>
<div id="colored-vessels-by-target" class="section level2">
<h2><span class="header-section-number">5.2</span> colored vessels by target</h2>
<script data-id="viz_13" data-object-name="viz_ail6RUX3" data-viz="ail6RUX3" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_13" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>Most of patients who have 0 colored vessels have been diagnosed with heart disease, which implies a strong negative correlation between colored vessels and heart disease.</p>
<hr />
</div>
</div>
<div id="slope" class="section level1">
<h1><span class="header-section-number">6</span> Slope</h1>
<div id="the-total-number-of-each-type-of-slope" class="section level2">
<h2><span class="header-section-number">6.1</span> The total number of each type of slope</h2>
</div>
<div id="slope-summary" class="section level2">
<h2><span class="header-section-number">6.2</span> slope summary</h2>
<p><script data-id="viz_14" data-object-name="viz_qjB9Lbe8" data-viz="qjB9Lbe8" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_14" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div> ## Its distribtion</p>
</div>
<div id="heart-disease-by-slope" class="section level2">
<h2><span class="header-section-number">6.3</span> heart disease by slope</h2>
<p><script data-id="viz_15" data-object-name="viz_yRG7ODI2" data-viz="yRG7ODI2" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_15" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div> From the above chart, most patients with a downwards slope of the ST segment post-peak exercise have been diagnosed with heart disease, so there might be a correlation between the two. In addition, most of the patients who had flat slope had not been diagnosed with heart disease.</p>
<hr />
</div>
</div>
<div id="the-relationship-between-the-presence-of-heart-disease-and-maximum-recorded-heart-rate." class="section level1">
<h1><span class="header-section-number">7</span> The relationship between the presence of heart disease and maximum recorded heart rate.</h1>
<div id="creating-a-scatter-plot-for-detecting-the-relationship" class="section level2">
<h2><span class="header-section-number">7.1</span> Creating a scatter plot for detecting the relationship</h2>
</div>
<div id="heart-disease-based-on-age-and-maximum-heart-rate-gpby-target" class="section level2">
<h2><span class="header-section-number">7.2</span> Heart Disease based on Age and Maximum Heart Rate gpby target</h2>
<p><script data-id="viz_16" data-object-name="viz_tDV0pWq0" data-viz="tDV0pWq0" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_16" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div> We can state that although there is no distict pattern as the dots for absent and present are mixed together, quite a few points with a higher heart rate have been diagnosed with heart disease regradless of age. Also, some patients with heart disease might be on the younger side but have a high heart rate.</p>
<hr />
</div>
</div>
<div id="what-next" class="section level1">
<h1><span class="header-section-number">8</span> What next!</h1>
<div id="the-best-course-of-action-is-to-take-a-closer-look-at-the-relationship-between-the-age-and-the-presence-and-the-absence-of-the-heart-disease" class="section level3">
<h3><span class="header-section-number">8.0.1</span> The best course of action is to take a closer look at the relationship between the age and the presence and the absence of the heart disease</h3>
<p>We can procced that by categrizing the age group into different bins then plot each group against the presence and the absence of the heart disease.</p>
</div>
<div id="presence-of-heart-disease-per-age-group" class="section level2">
<h2><span class="header-section-number">8.1</span> presence of heart disease per age group</h2>
<script data-id="viz_17" data-object-name="viz_UPw7WjY8" data-viz="UPw7WjY8" data-height="full" data-width="normal" data-fit="" ></script><div data-id="viz_17" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>The previous observation has been confirmed. Some patients who are the youngest have been diagnosed with heart disease when compared to those who have not been diagnosed.</p>
<hr />
</div>
</div>
<div id="investigating-the-relationship-between-the-presence-of-heart-disease-and-the-colesterol-column" class="section level1">
<h1><span class="header-section-number">9</span> Investigating the relationship between the presence of heart disease and the colesterol column</h1>
<p>A scatter plot is the horse for doing this step</p>
<div id="presence-of-heart-disease-based-on-age-and-cholesterol" class="section level2">
<h2><span class="header-section-number">9.1</span> Presence of Heart Disease based on Age and Cholesterol</h2>
<script data-id="viz_18" data-object-name="viz_PWb3Cbf1" data-viz="PWb3Cbf1" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="viz_18" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p><strong>Again, categorizing the cholesterol against the presence and the abence of </strong></p>
</div>
<div id="the-presence-of-heart-disease-per-cholesterol-group" class="section level2">
<h2><span class="header-section-number">9.2</span> The presence of heart disease per cholesterol group</h2>
<p><script data-id="viz_19" data-object-name="viz_mCM4Ebw8" data-viz="mCM4Ebw8" data-height="full" data-width="normal" data-fit="" ></script><div data-id="viz_19" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div> There is no much to tell; however, some patient who do have heart disease have high cholesterol. So, cholesterol does not show a strong relationship with heart disease or age.</p>
<hr />
</div>
</div>
<div id="finally-getting-correlations" class="section level1">
<h1><span class="header-section-number">10</span> Finally, getting correlations</h1>
<div id="visualizing-the-correlation---correlations---heatmap" class="section level2">
<h2><span class="header-section-number">10.1</span> Visualizing the correlation - Correlations - Heatmap</h2>
<script data-id="analytics_20" data-object-name="analytics_kzQ4GZW5" data-viz="heatmap" data-analysis="kzQ4GZW5" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="analytics_20" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
</div>
<div id="visualizing-the-correlation---significance" class="section level2">
<h2><span class="header-section-number">10.2</span> Visualizing the correlation - Significance</h2>
<script data-id="analytics_21" data-object-name="analytics_kzQ4GZW5" data-viz="significance" data-analysis="kzQ4GZW5" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="analytics_21" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
</div>
<div id="visualizing-the-correlation---scatter-matrix" class="section level2">
<h2><span class="header-section-number">10.3</span> Visualizing the correlation - Scatter Matrix</h2>
<script data-id="analytics_22" data-object-name="analytics_kzQ4GZW5" data-viz="scattermatrix" data-analysis="kzQ4GZW5" data-height="normal" data-width="normal" data-fit="" ></script><div data-id="analytics_22" style="width:100%; height:400px; display:table;margin-bottom:38px" class="viz-rendering-error viz-loading"><div style="width:100%; height:100%; display:table-cell; vertical-align:middle; text-align:center; font-size:14px; color:#999; background-color:white;font-family:sans-serif "><div>Loading... </div></div></div>
<p>From the previous correlations, slope, maximum heart rate and chest pain have a positive correlation with the target column.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1><span class="header-section-number">11</span> Conclusion</h1>
<p>This dataset contains medical data of 303 patients. This report has checked for ouliers, distributions and some correlations against the presence and absence of heart disease.</p>
</div>

<!-- BEGIN: Exploratory custom footer -->

<script>

var FULL_WIDTH_MARGIN_SIDE = 60;
var $body = $(document.body);
var screenWidth = $body.width();
var openOnDesktop = window.location.href.indexOf("desktop=true") > -1; 
var openInLocal = window.location.href.startsWith("file:"); 
var enableChartDataDownload = !openInLocal && !openOnDesktop && window.parent && window.parent.document && !!window.parent.document.querySelector('input#enable-csv-download');

// The default body max-width is set to 782px so if it is less than 902px 
// (782 + 60 left margin + 60 right margin) we cancel stretching images. 
$('img[width="full"]').each(function() {
  var $elem = $(this);
  if (screenWidth > 902) {
    $elem.attr("width", "");  // remove "full"
    var elemOffsetLeft = $elem.offset().left;
    $elem.css({"width": (screenWidth - (FULL_WIDTH_MARGIN_SIDE*2) )+'px', "max-width": (screenWidth - (FULL_WIDTH_MARGIN_SIDE*2) )+'px', "margin-left": (-1 *(elemOffsetLeft - FULL_WIDTH_MARGIN_SIDE)) + "px" });
  } else {
    $elem.attr("width", "100%"); // replace "full" with "100%"
  }
});

$('a').each(function(index, a){
  var $link = $(this);
  if($link.attr('href') && !$link.attr('href').startsWith('file')){// tab has a with href="file" so exclude tab
    $link.attr('target','_blank'); // make sure link opens another tab or window.
  }
});

var _enableLinks = function() {
  if (!openOnDesktop) {
    return false;
  }
  $('a').each(function(index, a){
    var $link = $(this);
    // Enable links starting with http* and mailto. Others are used for 
    // other purpose such as map, tab, etc so don't touch those. 
    if($link.attr('href') && /^(http:\/\/|https:\/\/|mailto:)/.test($link.attr('href'))){
      $link.off("click");
      $link.on("click", function (e) {
        e.preventDefault(); // make sure to block default to avoid external content rendered inside Exploratory Desktop.
        window.parent.postMessage(JSON.stringify({action:'OpenExternalLink', url: $link.attr('href')}),'*');
        //MarkdownActions.openExternalLink($link.attr('href'));
      });
    }
  });
};

var onMessageReceiveHandler = function(event){
  var data = null;   
  try {
    data = JSON.parse(event.data);
  } catch(e) {
    // The event.data may be just a text like 'ready'. 
    // We ignore those cases. 
  }
  if (!data) {
    return;
  }
  if(data.action) {
    switch(data.action) {
      case "ScrollY":
        window.scrollTo(0, data.scrollY);
        break;
      case "EnableLinks":
        _enableLinks();
        break;
    }
  }

}
window.addEventListener('message', onMessageReceiveHandler, false); 

var ready = function(){
  window.parent.postMessage(JSON.stringify({action:'DocumentReady'}),'*');
}
document.addEventListener("DOMContentLoaded", ready);

</script>

<script>


// Find exploratory vizs. Check the existence of 'data-id' and 'data-viz' attributes. 
var $vizs = $("script[data-id][data-viz]");
// View area width. 
var screenWidth = $(document.body).width();
// View area height. 
var screenHeight = $(window).height();

// In case of shared note, the note is loaded in the iframe so the screen
// height is shorter than the actual screen size so we need to adjust it.
// Accessing the parent fails if you open it locally (including opening on desktop) 
// because of the cross origin so just to check. 
if (!/^file:/.test(window.location.href)) {
  var offset = $(window.parent.document).find("iframe.markdown-content-frame").offset();
  if (offset && offset.top) {
    screenHeight+=offset.top;
  }
}


// Capturing charts/analytics snapshot images for Word output and 
// self-contained HTML output.  (self-contained HTML output is not used now.)
var _generateSnapshot = function(id, objectName, vizName, cb) {
  if (!cb) {
    // Dummy callback.
    cb = function() {};
  }
  var analyticsName = null;

  var viz = window[objectName];
  if (!window._datauris) 
    window._datauris = {};
      
  // If it is analytics, find the viz metadata in analytics json.
  if (/^analytics_/.test(id)) {
    // If no corresponding metadata found, just return. 
    if (!viz.vizs[vizName]) {
      cb(null, id, objectName, vizName);
      return;
    }
    analyticsName = viz.name;
    viz = viz.vizs[vizName].metadata;
  }

  if (VizUtil.isPivot(viz.options.marker)) {
      // do nothing.
      cb(null, id, objectName, vizName);
  } else if (VizUtil.isLeaflet(viz.options.marker)) {
    var map = window._leaflet_map_objs[id];
    var options = {
      exclude: ['.leaflet-control-zoom', '.leaflet-control-attribution', '.info-box'],
      format: 'image/png'
    };
    return map.export(options)
    .then(function(res) {
      window._datauris[id] = res ? res.data : "null";
      cb(res ? res.data : null, id, objectName, vizName);
      return null;
    })
    .catch(function(e){
      window._datauris[id] = "null";
      cb(null, id, objectName, vizName);
    });
  } else if (VizUtil.isROutput(viz.options.marker)) {
    cb(null, id, objectName, vizName); 
  } else if (VizUtil.isPlotly(viz.options.marker)) {
    // plotly
    var graphDiv = document.querySelector('div[data-id="div-'+id+'"] .js-plotly-plot');
    var origw = graphDiv.clientWidth;
    var origh = graphDiv.scrollHeight;
    var width = 1200; 
    var height = graphDiv.scrollHeight > graphDiv.clientHeight ? width * origh / origw : 800;
    return Plotly.toImage(graphDiv,  {format: "png", width: width, height: height, scale: 2})
    .then(function(res){
      window._datauris[id] = !!res ? res : "null";
      cb(res, id, objectName, vizName);
    }) 
    .catch(function(e){
      window._datauris[id] = "null";
      cb(null, id, objectName, vizName);
    });
  } else { // Shouldn't reach here, but just in case.
    cb(null, id, objectName, vizName);
  }
};


var _renderSingleViz = function($div, id, vizName, analyticsName, viz, minHeight) {
  var lang = document.documentElement.lang || null;
  var $parent = $div.parent();

  // Show no data message if data is empty. 
  // Some chart can render its own no data message so bypass for those cases. 
  if (VizUtil.shouldRenderNoData(viz.options.data, viz.options)) {
    // Show the query error message if available.
    VizUtil.renderNoData($div[0], viz.options._lastQueryErrorMessage, null, null, lang);
    // Mark it as rendered.
    window._vizRenderingStatus[id] = true;    
    return;
  }

  if (VizUtil.isPivot(viz.options.marker)) {
    // Render pivot table
    PivotTableGenerator.render(viz.options, viz.options.data, $div[0],
      null, null, lang);
    // adjust height 
    var pTitleHeight = $div.find('.pivot-title').outerHeight(true); 
    if ($div.find('.pivot-title').hasClass("hidden")) {
      pTitleHeight = 0;
    }
    var pColTitleHeight = $div.find('.pivot-col-title').outerHeight(true);
    if ($div.find('.pivot-col-title').hasClass("hidden")) {
      pColTitleHeight = 0;
    }
    var pToolbarHeight = $div.find('.pivot-toolbar').outerHeight(true);
    if ($div.find('.pivot-toolbar').hasClass("hidden")) {
      pToolbarHeight = 0;
    }
    var pHeaderHeight = $div.find('.pivot-table-frame.pivot-table-col-header-frame').outerHeight();
    var pBodyHeight = $div.find('.pivot-table-frame.pivot-table-body-frame').outerHeight();
    var horizScrollBarHeight = 18;
    var pHeight = pTitleHeight + pColTitleHeight + pHeaderHeight + pToolbarHeight + pBodyHeight + horizScrollBarHeight;
    //console.log(pTitleHeight + " " +pColTitleHeight + " " + pHeaderHeight + " " + pBodyHeight + " " + pHeight + " " + $div.height())
    if (viz.options.marker==="singlevalue"){
      $parent.css({'height':'120px', 'min-height':'120px'});
    } else {
      // Remove min-height for Table, Pivot, Summarize Table
      $parent.css({"min-height":""});
      // If the height is set to the div, adjust the height depending 
      // on the table actual height and min height. 
      // In case of "full" mode, there is no height set 
      // in order to show all rows so just ignore it. 
      if ($parent[0].style.height && minHeight) {
        $parent.height(Math.min(pHeight, minHeight));
      }
    }

  } else if (VizUtil.isLeaflet(viz.options.marker)) {
    // Render leaflet map
    switch (viz.options.marker) {
      case 'map':
      case 'maphmap':
        $parent.parent().parent().css({"background-color":"#fff"});
        MapGenerator.render(viz.options, viz.options.data, $div[0], 
        null, null, null, null, null, null, null, lang);
        break;
      case 'geojson':
        $parent.parent().parent().css({"background-color":"#fff"});
        var geojsonObjectName = 'geojson_' + viz.options.geojson; 
        MapGenerator.render(viz.options, viz.options.data, $div[0], window[geojsonObjectName],
          null, null, null, null, null, null, lang);
        break;
      case 'easymap':
        $parent.parent().parent().css({"background-color":"#fff"});
        var geojsonObjectName = 'geojson_' + viz.options.easymapMap; 
        MapGenerator.render(viz.options, viz.options.data, $div[0], window[geojsonObjectName],
          null, null, null, null, null, null, lang);
        break;
      default:
        break;
    }
  } else if (VizUtil.isROutput(viz.options.marker)) {
    // Locate the image in center.
    $parent.css({'text-align': 'center'});
    // Render R output
    ROutputGenerator.render(
      viz.options, 
      {"outputFile": [ (window._baseUrl ? window._baseUrl + "/note_content/" : "" ) + "libs/exploratory/layout_output/"+ (analyticsName ? analyticsName+"-" : "") + viz.name+".png"]}, 
      $div[0], 
      true,
      null,
      null,
      lang
    );
  } else if (VizUtil.isPlotly(viz.options.marker)) {
    // Show/Hide layout toolbar.
    viz.options.showFacetLayoutTool = window["exploratory-hide-chart-toolbars"] ? "off" : "on";
    // Render plotly graph
    $parent.css({"overflow-y":"auto"});
    PlotlyGraphGenerator.render(viz.options, viz.options.data, $div[0], true,
      null, null, null, null, null, null, 
      // Pass dummy function to onPropUpdateCallback to enable toolbar.
      function(e){ return false; }, 
      lang);
  }
};

var _renderVizPanel = function() {
  var lang = document.documentElement.lang || null;
  var $elem = $(this); // This script tag
  var id = $elem.attr("data-id");
  var objectName = $elem.attr("data-object-name");
  // Hide loading placeholer
  // It could match multiple elements if there are same charts.
  $('.viz-loading[data-id="'+id+'"]').hide();
  // Backward compatibility. The rmarkdown renders the old cached data if available.
  $('.viz-rendering-error[id="loading-'+id+'"]').hide();
  
  var viz = window[objectName];
  var vizName = $elem.attr("data-viz");
  var analyticsName = null;
  var annotation = viz.annotation;
  // Check both viz.displayName and viz.options.displayName 
  // for the backward compatibility.
  var vizDisplayName = viz.displayName || viz.options.displayName;

  // If it is analytics, find the viz metadata in analytics json.
  if (/^analytics_/.test(id)) {
    if (viz.vizs[vizName]) {
      analyticsName = viz.name;
      var analyticsDisplayName = viz.displayName;
      viz = VizUtil.analyticify(viz.vizs[vizName].metadata);
      // Check both viz.displayName and viz.options.displayName 
      // for the backward compatibility.
      vizDisplayName = analyticsDisplayName + " - " + (viz.displayName || viz.options.displayName);
    } else {
      // If no metadata found, just set viz to null. 
      // Usually it shouldn't happen but just in case it happens. #9689
      viz = null;
    }
  }

  var containerWidth = $elem.parent().width();

  // The default body max-width: 782px. 
  // The default body width including margin: 902px (782 + 60(side margin) * 2), 
  var FULL_WIDTH_MARGIN_SIDE = screenWidth > 902 ? 60 : 0;  
  var FULL_HEIGHT_MARGIN_TOP = 10;  

  var isFullHeightMode = false;
  var isFullWidthMode = false;

  // User-specified height
  var userHeightStr = $elem.attr("data-height");
  var userHeight = null;
  if (userHeightStr) {
    if (userHeightStr==="full") {
      isFullHeightMode = true;
      userHeight = screenHeight  - FULL_HEIGHT_MARGIN_TOP;
    } else if (/%$/.test(userHeightStr)) {
      userHeight = parseInt(userHeightStr.replace("%",""));
      userHeight = isNaN(userHeight) ? null : (screenHeight * userHeight / 100) - FULL_HEIGHT_MARGIN_TOP;
    } else {
      userHeight = parseInt(userHeightStr.replace("px",""));
      userHeight = isNaN(userHeight) ? null : userHeight;
    }
  }
  // User-specified width
  var userWidthStr = $elem.attr("data-width");
  var userWidth = null;
  if (userWidthStr) {
    if (userWidthStr==="full") {
      isFullWidthMode = true;
      userWidth = screenWidth - FULL_WIDTH_MARGIN_SIDE*2;
    } else if (/%$/.test(userWidthStr)) {
      userWidth = parseInt(userWidthStr.replace("%",""));
      userWidth = isNaN(userWidth) ? null : (screenWidth * userWidth / 100) - (FULL_WIDTH_MARGIN_SIDE*2);
    } else {
      userWidth = parseInt(userWidthStr.replace("px",""));
      userWidth = isNaN(userWidth) ? null : userWidth;
    }
  }

  // Set the min height. If userHeight is available, just use it. 
  // If not, try to set a rectangle shape. Use landscape mode If the screen is 
  // large enough. If small (mobile case), use portrait mode.
  var minHeight = userHeight || (containerWidth<500 ? containerWidth*8/5 : containerWidth*5/8);

  // Insert a viz canvas div right after the script tag.
  // If there's already a div there (refresh case), do nothing.
  var $div = $('div[data-id="div-'+id+'"]');
  var $outerDiv = $div.parent();
  if ($div.length === 0) {
    $div = $("<div>").attr('data-id','div-'+id).css({"min-height":minHeight+"px", "margin-bottom":"38px" }).addClass("viz-container markdown-viz-container")   
    $outerDiv = $("<div>").addClass("viz-container-outer").append($div);
    $elem.after($outerDiv);
  }
  $div.show();

  // If viz is not available, render no data and exit. 
  if (!viz) {
    $div.height(minHeight);
    VizUtil.renderNoData($div[0], "No chart data found: "+vizName, null, null, lang);
    // Mark it as rendered.
    window._vizRenderingStatus[id] = true;  
    return;
  } 
 
  // Toolbar
  var $toolbarDiv = $outerDiv.find('.note-pane-toolbar'), $toolbarOuterDiv = null;
  if ($toolbarDiv.length === 0) {
    $toolbarDiv = $('<div class="note-pane-toolbar"/>');
    $toolbarOuterDiv = $('<div class="note-pane-toolbar-outer"/>');
    $outerDiv.prepend($toolbarOuterDiv.append($toolbarDiv));
  }
  var $toolbarOuterDiv = $toolbarDiv.parent();
 
  // Add a border to table/pivot
  if ( /^(table|pivot|summarytable)$/.test(viz.options.marker)) {
    $div.css({"border-radius":"3px", "border":"1px solid #f0f0f0", "padding":"4px 0px 0px 4px"});
  }
  // If plotly viz, add white background color to make viz visible on TOC
  // if the viz width="full".
  if (! /^(table|pivot|summarytable|map|maphmap|geojson|easymap)/.test(viz.options.marker)) {
    $div.css({"background-color": "#ffffff"});
  }

  var _generateSnapshotCb = function() {
    window.parent.postMessage(JSON.stringify({action:'SnapshotReady', datauris: window._datauris}),'*');
  };
  var $trigger = $("<a>").attr({'data-id':'a-'+id, vizName, 'data-object-name':objectName}).addClass("viz-snapshot-trigger").click(_generateSnapshot.bind(null, id, objectName, vizName, _generateSnapshotCb));
  $elem.after($trigger);   

  var divWidth  = $div.width(); 
  var divHeight = $div.height();
  var width = userWidth ||  divWidth;
  var height = userHeight || divHeight

  // If no scroll specified for height, not to set hight to let the div 
  // expand to fit the content without the vertical scrollbar. 

  // allow full height setting only if 
  // 1. the viz is either pivot or table, or 
  // 2. plotly chart with repeating.
  var allowFullHeight = !!viz.options.facet || /^(table|pivot|summarytable)$/.test(viz.options.marker);
  if (isFullHeightMode && allowFullHeight) {
    // In case of full height setting, not to specify height. 
  } else if (!userHeight && VizUtil.isROutput(viz.options.marker)) {
    // In case of R-based output chart and hight is not specified explicitly 
    // by user, not to set the height to use the full chart area div width. #14492. 
  } else {
    $div.css({'height': height+'px'});
  }

  $div.css({'width': width+'px'});
  $toolbarOuterDiv.css({'width': width+'px'});

  // If the width is given by user, adjust the left margin to locate the viz 
  // in the center. If it is in the full width mode, adjust the margin based 
  // on the screen size. 
  if (isFullWidthMode) {
    var marginLeft = (-1 * ($div.offset().left - FULL_WIDTH_MARGIN_SIDE)) + 'px';
    $div.css('margin-left', marginLeft);
    $toolbarOuterDiv.css('margin-left', marginLeft);
  } else if (userWidth && userWidth !== divWidth) {
    var marginLeft = ((userWidth - divWidth) / 2 * -1 ) + 'px';
    $div.css('margin-left', marginLeft);
    $toolbarOuterDiv.css('margin-left', marginLeft);
  }

  // in case of facet, make the viz width a bit smaller for the vert scroll bar. 
  viz.options.width = (!viz.options.facet ? width : width-20);
  viz.options.height= height;

  // Render a chart.
  var $innerDiv = $div.find('> .inner-div');
  if ($innerDiv.length === 0) {
    $innerDiv = $('<div class="inner-div" style="width:100%; height:100%">');
    $div.append($innerDiv);
  }
  _renderSingleViz($innerDiv, id, vizName, analyticsName, viz, minHeight);

  // Chart title for the "download" HTML attribute for chart data and image download.
  var chartTitleForDownload = vizDisplayName.replace('"', "&quot;");

  // Show comment button.
  var $commentBtn = null, commentHtml = null;
  if (viz.options.marker !== "singlevalue" && annotation && !document.querySelector('div.show-comment-btn[data-show-comment-id="'+id+'"]')) {
    var converter = new showdown.Converter();
    commentHtml = converter.makeHtml(annotation);
    $commentBtn = $('<div data-show-comment-id="'+id+'" class="show-comment-btn"></div>');
    $toolbarDiv.append($commentBtn);
  }

  // Download image button.
  var $downloadImgMenu = null;
  if (!openOnDesktop && !openInLocal && VizUtil.isPlotly(viz.options.marker) && !document.querySelector('a[data-image-download-id="'+id+'"]')) {
    var _downloadImg = function(ev) {
      ev.preventDefault(); 
      var _downloadSnapshotCb = function(datauri, id, objectName, vizName) {
        try {
          var _a = document.createElement('a');
          _a.style.display = 'none';
          _a.href = datauri;
          // the filename you want
          _a.download = chartTitleForDownload + '.png';
          document.body.appendChild(_a);
          _a.click();
        } catch(e) {
          console.log("Downloading chart image failed: ",e.message, id, objectName, vizName);
        }
      }
      _generateSnapshot(id, objectName, vizName, _downloadSnapshotCb);
    }
    $downloadImgMenu = $('<a data-image-download-id="'+id+'" href="">' + VizUtil.getMessage(lang, "Export Chart Image") + '</a>').click(_downloadImg);
  }

  // Download data button.
  var $downloadDataMenu = null;
  if (enableChartDataDownload && viz.options.marker !== "singlevalue" && !document.querySelector('a[data-download-id="'+id+'"]')) {
    // Use download HTML attibute for specifying a filename. 
    // It will automatically escape/replace punctuation characters.
    $downloadDataMenu = $('<a data-download-id="'+id+'" href="data/'+ (analyticsName ? analyticsName + "_" : "")+viz.name+'.csv" download="'+ chartTitleForDownload +'.csv">' + VizUtil.getMessage(lang, "Export Chart Data") + '</a>');
  }

  // Add download menu dropdown if download is available.
  if ($downloadImgMenu || $downloadDataMenu) {
    var $downloadMenuDropdown = $('<div class="download-dropdown-menu"/>');
    $downloadMenuDropdown.append('<a href="#">\xa0</a>')
    var $downloadUl = $('<ul>'); 
    $downloadMenuDropdown.append($downloadUl)
    if ($downloadImgMenu) {
      $downloadUl.append($('<li>').append($downloadImgMenu))
    }
    if ($downloadDataMenu) {
      $downloadUl.append($('<li>').append($downloadDataMenu))
    }
    $toolbarDiv.append($downloadMenuDropdown);
  }

  // Full screen view support. 
  if (viz.options.marker !== "singlevalue") {

    // If the full screen view is open, re-render the chart in the screen too.
    // This is for resizing handling.
    var $existingVizDiv = $('div[data-preview-id="'+id+'"]');
    if ($existingVizDiv.length > 0) {
      viz.options.width = $existingVizDiv.width();
      viz.options.height= $existingVizDiv.height();
      _renderSingleViz($existingVizDiv, id, vizName, analyticsName, viz, null/*minHeight - we don't need this setting in the preview pane. */);
    } 
    // Full-screen toggle button.
    var $fullscBtn = $('div.full-screen-toggle-btn[data-toggle-id="'+id+'"]'); 
    if ($fullscBtn.length === 0) {
      $fullscBtn = $('<div data-toggle-id="'+id+'" class="full-screen-toggle-btn" aria-label="' + VizUtil.getMessage(lang, "Show in fullscreen") + '" data-microtip-position="bottom-left" role="tooltip"></div>');
      $fullscBtn.on("click", function(){
        var id = $(this).attr("data-toggle-id");
        var $fullscDiv = $('<div class="full-screen-pane viz-container"></div>');
        var $vizDiv = $('<div data-preview-id="'+id+'" class="full-screen-pane-inner"></div>');
        var $closeBtn = $('<div class="full-screen-close-btn"></div>');
        $closeBtn.on("click", function(){
          // Get back the original width and height.
          viz.options.width = viz.options._width;
          viz.options.height = viz.options._height;
          // Remove the full-screen dialog.
          $fullscDiv.remove();
        });
        $fullscDiv.append($vizDiv);
        $fullscDiv.append($closeBtn);
        $(document.body).append($fullscDiv);

        // Remenber the current width/height. 
        // We will get it back once the full-screen mode is closed.
        viz.options._width = viz.options.width;
        viz.options._height = viz.options.height;

        viz.options.width = $vizDiv.width();
        viz.options.height= $vizDiv.height();
        // Render a chart.
        _renderSingleViz($vizDiv, id, vizName, analyticsName, viz);
        // Update the links in the chart in the full-screen view.
        _enableLinks();
      });
      $toolbarDiv.append($fullscBtn);
    }
  }

  // Init show comment balloon.
  // We should do this once all the buttons are added to the toolbar
  // because the balloon alignment depends on the width of the toolbar.
  if ($commentBtn) {
    $commentBtn.balloon({
      contents: '<div class="title-area">'+VizUtil.getMessage(lang, "Comment")+'</div><div class="body-area">' + commentHtml + '</div>',
      html: true,
      position: "bottom left",
      classname: "comment-balloon",
      minLifetime: 0, showDuration: 0, hideDuration: 0,
      css: {
        transform: "translateX(" + ($toolbarDiv.width() - 10) + "px)",
        border: "1px solid #ddd",
        borderRadius: "2px",
        padding: "10px 16px",
        fontSize: "14px",
        fontWeight: "normal",
        backgroundColor: "#fff",
        color: "#666",
        boxShadow: "none",
        minWidth: "200px",
        zIndex: "1100",
        whiteSpace: "pre-wrap",
        borderRadius: "6px",
        opacity: "1",
        maxWidth: Math.min(400, ($div.outerWidth() - 20)) + "px",
      },
    });
}

  // Mark it as rendered.
  window._vizRenderingStatus[id] = true;
  _enableLinks();
  window.parent.postMessage(JSON.stringify({action:'SetRenderingStatus', renderingStatus: window._vizRenderingStatus}),'*');
}

// Track the viz rendering status. 
window._vizRenderingStatus = {};

// Render charts.
window._renderViz = function(){
  $vizs.each(function(index) {
    window._vizRenderingStatus[$(this).attr("data-id")] = false;
    setTimeout(_renderVizPanel.bind(this) ,50);
  });
};

// Show loading messages on charts. 
window._showLoading = function(){
  $vizs.each(function(index) {
    var dataId = $(this).attr("data-id");
    $('.viz-loading[data-id="'+dataId+'"]').show();
    $('div[data-id="div-'+dataId+'"]').hide();
  });
};

// Reload chart metadata. Used in Interactive mode.
window._reloadMetadata = function(baseUrl){
  // Save the base URL to the window object 
  // for R-based chart output rendering later.
  if (baseUrl) {
    window._baseUrl = 
      window.location.protocol + 
      "//" + 
      window.location.host + 
      baseUrl;
  }
  var cb = "?cb=" + Date.now();
  $vizs.each(function(index) {
    var analyticsId = $(this).attr("data-analysis"),
      vizId = $(this).attr("data-viz"),
      url = "";
    if (analyticsId) {
      url = baseUrl+"/note_content/libs/exploratory/analytics/"+analyticsId+".js" + cb;
    } else {
      url = baseUrl+"/note_content/libs/exploratory/layout/"+vizId+".js" + cb;
    }
    $(document.body).append('<script src="'  + url +'" />');
  });
};

// Render charts at loading time. 
window._renderViz();


</script>
<!-- END: Exploratory custom footer -->



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
